{% load static %}
<div class="chat-app" id="card_chat-app">
    <div class="chat">
        {% if conversation %}
            <div class="chat-header">
                <div class="row">
                    <div class="col-lg-6" id="chat-header">
                        {% if conversation.participants.all.0 == request.user %}
                        <a href="{{ conversation.participants.all.1.profile.get_absolute_url }}">
                            <img src="{{ conversation.participants.all.1.profile.get_image }}" alt="avatar">
                        </a>
                        <div class="chat-about">
                            <h6 class="m-b-0">{{ conversation.participants.all.1.profile.get_full_name }}</h6>
                            <small>{{ conversation.lastmessage_created }}</small>
                        </div>
                        {% else %}
                        <a href="#" data-toggle="modal" data-target="#view_info">
                            <img src="{{ conversation.participants.all.0.profile.get_image }}" alt="avatar">
                        </a>
                        <div class="chat-about">
                            <h6 class="m-b-0">{{ conversation.participants.all.0.profile.get_full_name }}</h6>
                            <small>{{ conversation.lastmessage_created }}</small>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="chat-history" id="chat-history">
                <ul class="m-b-0">
                    {% for message in conversation.messages.all %}
                        {% if message.sender == request.user %}
                        <li class="clearfix">
                            <div class="message-data text-right">
                                <small class="message-data-time">{{ message.created }}</small>
                            </div>
                            <div class="message other-message float-right">{{ message.body }}</div>
                        </li>
                        {% else %}
                            <li class="clearfix">
                                <div class="message-data">
                                    <small class="message-data-time">{{ message.created }}</small>
                                </div>
                                <div class="message my-message">{{ message.body }}</div>                                    
                            </li>
                        {% endif %}
                    {% endfor %}                               
                </ul>
            </div>
            <div class="chat-message ">
                <form class="replyform flex justify-between" autocomplete="off"
                hx-post="{% url 'inbox:send' conversation.pk %}"
                hx-target="#chat-history"
                hx-swap="outerHTML"
                _="on htmx:afterRequest reset() me">
                    {% csrf_token %}
                    {{ form.body }}
                    <button class="block" type="submit">Submit</button>                              
                </form>
            </div>
        {% else %}
            <div class="chat-default">
                <small>Selecciona una conversaci√≥n!</small>
            </div>
        {% endif %}
    </div>
</div>



